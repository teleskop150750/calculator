package com.example.util;

/**
 * Класс для форматирования чисел для отображения.
 * <p>
 * Предоставляет методы для красивого отображения результатов вычислений,
 * убирая незначащие нули и обрабатывая погрешности вычислений с плавающей
 * точкой.
 * </p>
 */
public class NumberFormatter {

    /** Малый порог для сравнения чисел с плавающей точкой. */
    private static final double EPSILON = 1e-10;

    /**
     * Форматирует результат вычисления для удобного отображения.
     * <p>
     * Убирает незначащие нули и десятичную точку для целых чисел,
     * а также корректирует значения, близкие к нулю из-за погрешностей
     * вычислений с плавающей точкой.
     * </p>
     * 
     * <h3>Примеры форматирования:</h3>
     * 
     * <pre>
     * 5.0        →  "5"         (целое число)
     * 3.14159265 →  "3.14159265" (до 8 знаков)
     * 2.50000000 →  "2.5"       (убраны нули)
     * 0.00000001 →  "0"         (близко к нулю)
     * </pre>
     * 
     * @param value число для форматирования
     * @return отформатированная строка
     */
    public static String format(double value) {
        // Очень малые значения (погрешность) приводим к нулю
        if (Math.abs(value) < EPSILON)
            value = 0;

        // Если число целое, показываем без дробной части
        if (value == (long) value) {
            return String.format("%d", (long) value);
        }

        // Для дробных чисел: до 8 знаков, убираем концевые нули
        return String.format("%.8f", value)
                .replaceAll("0+$", "") // Удаляем нули в конце
                .replaceAll("\\.$", ""); // Удаляем точку, если дробной части нет
    }
}
